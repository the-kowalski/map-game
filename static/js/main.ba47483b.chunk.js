(this["webpackJsonpmap-game"]=this["webpackJsonpmap-game"]||[]).push([[0],{19:function(e,t,n){e.exports={mapContainer:"OpenMap_mapContainer__SXaVi"}},20:function(e){e.exports=JSON.parse('{"cities":[{"name":"Amsterdam","lat":52.3667,"lng":4.8833},{"name":"Berlin","lat":52.52,"lng":13.4049},{"name":"Paris","lat":49.0097,"lng":2.5477},{"name":"Rome","lat":41.9339,"lng":12.4542},{"name":"London","lat":51.5098,"lng":-0.118},{"name":"Madrid","lat":40.4167,"lng":-3.7037},{"name":"Kyiv","lat":50.45,"lng":30.5233},{"name":"Budapest","lat":47.4979,"lng":19.0402}]}')},26:function(e,t,n){},27:function(e,t,n){},48:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),a=n(18),s=n.n(a),i=(n(26),n(27),n(2)),o=n(3),u=n(21),l=n(4),d=n.n(l),f=n(19),j=n.n(f),b=(n(45),n(0));d.a.accessToken="pk.eyJ1Ijoia293YWxza2lkZXY3IiwiYSI6ImNrc2htdzBzNTAxcXQyb25jdmt2OTEwbDYifQ.Y7w2cwT7wBZWB17prVvSWA",d.a.workerClass=n(47).default;var p={userMarker:null,solutionMarker:null},m=function(e){var t=e.gamePhase,n=e.currentCity,c=e.setUserCoordinates,a=Object(r.useRef)(null),s=Object(r.useRef)(null),o=Object(r.useState)(15),u=Object(i.a)(o,2),l=u[0],f=u[1],m=Object(r.useState)(55),O=Object(i.a)(m,2),g=O[0],h=O[1],y=Object(r.useState)(3),C=Object(i.a)(y,2),k=C[0],x=C[1],v=Object(r.useCallback)((function(){var e=new d.a.Marker({color:"#5ceb34"}).setLngLat([n.lng,n.lat]).addTo(s.current);p.solutionMarker=e;var t=p.userMarker.getLngLat(),r=p.solutionMarker.getLngLat();!function(e,t,n){e.current.addSource("route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[[t.lng,t.lat],[n.lng,n.lat]]}}}),e.current.addLayer({id:"route",type:"line",source:"route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#888","line-width":8}})}(s,t,r)}),[n.lng,n.lat]),M=Object(r.useCallback)((function(){p.userMarker.remove(),p.userMarker=null,p.solutionMarker.remove(),p.solutionMarker=null,s.current.removeLayer("route"),s.current.removeSource("route"),p.solutionMarker=null}),[]);return Object(r.useEffect)((function(){null!==p.userMarker&&("guessing"===t&&M(),"displayResult"===t&&v())}),[t,v,M]),Object(r.useEffect)((function(){s.current||(s.current=new d.a.Map({container:a.current,style:"mapbox://styles/kowalskidev7/ckshnj6z698is17pjzhlguevd",center:[l,g],zoom:k}),s.current.on("click",(function(e){!function(e,n){if("displayResult"!==t){null!==p.userMarker&&(p.userMarker.remove(),p.userMarker=null);var r=new d.a.Marker({color:"#eb9534"}).setLngLat([e,n]).addTo(s.current);p.userMarker=r,c(e,n)}}(e.lngLat.lng,e.lngLat.lat)})))})),Object(r.useEffect)((function(){s.current&&s.current.on("move",(function(){f(s.current.getCenter().lng.toFixed(4)),h(s.current.getCenter().lat.toFixed(4)),x(s.current.getZoom().toFixed(2))}))})),Object(b.jsx)("div",{children:Object(b.jsx)("div",{ref:a,className:j.a.mapContainer})})},O=n(9),g=n.n(O),h=n(20),y=JSON.parse(JSON.stringify(h)),C={phase:"guessing",score:1500,numOfGuessedCities:0,currentCity:y.cities[0],currentCityDifference:0,userCoordinates:null,finished:!1},k=function(e,t){switch(t.type){case"newGame":return C;case"nextRound":return Object(o.a)(Object(o.a)({},e),{},{phase:"guessing",currentCity:t.payload.city,currentCityDifference:0,userCoordinates:null});case"checkedSolution":var n=e.score-t.payload.difference,r=t.payload.difference<=50;return Object(o.a)(Object(o.a)({},e),{},{phase:"displayResult",score:n<0?0:n,numOfGuessedCities:r?e.numOfGuessedCities+1:e.numOfGuessedCities,currentCityDifference:t.payload.difference,finished:n<=0});case"placedUserMarker":return Object(o.a)(Object(o.a)({},e),{},{userCoordinates:{lng:t.payload.lng,lat:t.payload.lat}});default:console.log("Error")}},x=function(){var e=Object(r.useState)(y.cities),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useReducer)(k,C),s=Object(i.a)(a,2),o=s[0],l=s[1];Object(r.useEffect)((function(){c(y.cities)}),[]);return Object(b.jsxs)("section",{children:[Object(b.jsx)(m,{gamePhase:o.phase,currentCity:o.currentCity,setUserCoordinates:function(e,t){return l({type:"placedUserMarker",payload:{lng:e,lat:t}})}}),Object(b.jsxs)("div",{className:g.a.gameControls,children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("p",{children:"".concat(o.numOfGuessedCities," ").concat(1===o.numOfGuessedCities?"city":"cities"," placed correctly")}),Object(b.jsx)("p",{children:"".concat(o.score,"km left")}),Object(b.jsx)("hr",{}),Object(b.jsx)("p",{children:"Select the location of ".concat(o.currentCity.name,"!")})]}),"guessing"===o.phase&&null!==o.userCoordinates&&Object(b.jsx)("div",{children:Object(b.jsx)("button",{className:"button",onClick:function(){var e=Math.round(Object(u.a)([o.userCoordinates.lng,o.userCoordinates.lat],[o.currentCity.lng,o.currentCity.lat],{units:"kilometers"}));l({type:"checkedSolution",payload:{difference:e}})},children:"Check!"})}),"displayResult"===o.phase&&Object(b.jsxs)("div",{children:[o.currentCityDifference<=50?Object(b.jsx)("h4",{style:{color:"green"},children:"Correct!"}):Object(b.jsx)("h4",{style:{color:"red"},children:"Failed!"}),Object(b.jsx)("p",{children:"Distance: ".concat(o.currentCityDifference,"km")}),!o.finished&&Object(b.jsx)("button",{className:"button",onClick:function(){var e=Math.floor(Math.random()*n.length),t=n[e];l({type:"nextRound",payload:{city:t}})},children:"Next!"})]})]}),o.finished&&Object(b.jsxs)("div",{className:g.a.finishBanner,children:[Object(b.jsx)("h2",{children:"You guessed ".concat(o.numOfGuessedCities," ").concat(1===o.numOfGuessedCities?"city":"cities"," correctly!")}),Object(b.jsx)("button",{className:"button",onClick:function(){l({type:"newGame"})},children:"New Game"})]})]})};var v=function(){return Object(b.jsx)("div",{className:"App",children:Object(b.jsx)(x,{})})},M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,49)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};s.a.render(Object(b.jsx)(c.a.StrictMode,{children:Object(b.jsx)(v,{})}),document.getElementById("root")),M()},9:function(e,t,n){e.exports={gameControls:"Game_gameControls__61M5E",finishBanner:"Game_finishBanner__3lGvd"}}},[[48,1,2]]]);
//# sourceMappingURL=main.ba47483b.chunk.js.map